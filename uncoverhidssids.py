#!/usr/bin/python

import socket
from scapy.all import *

hidden_ssid_aps = set()

def PacketHandler(pkt) :

	if pkt.haslayer(DotllBeacon) :

		if not pkt.info :
			if pkt.addr3 not in hidden_ssid_aps :
				hidden_ssid_aps.add(pkt.addr3)
				print "HIDDEN SSID Neywork Found! BSSID: ", pkt.addr3

	elif pkt.haslayer(DotllProbeResp) and ( pkt.addr3 in hidden_ssd_aps ) :
		print "HIDDEN SSID Uncovered! ", pkt.info, pkt.addr3

sniff(iface = sys.argv[1], count = int( sys.argv[2]), prn = PacketHandler)
