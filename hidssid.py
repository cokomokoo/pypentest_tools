#!/usr/bin/python

import sys
from scapy.all import *

mymac = 'aa:aa:aa:aa:aa:aa'
brdmac = 'ff:ff:ff:ff:ff:ff'

for ssid in open(sys.argv[1], 'r').readlines() :

    pkt = RadioTap() / Dotll( type = 0, subtype = 4, addrl = brdmac, addr2 = mymac, addr3 = brdmac) / DotllProbeReq() / DotllElt(ID=0, info = ssid.strip()) / DotllElt(ID=1, info =
"\x02\x04\x0b\x16") / DotllElt(ID=3, info = "\x08")

    print "\nTrying SSID : ", ssid
    sendp(pkt, iface = "mon0", count = 3, inter = .3)
